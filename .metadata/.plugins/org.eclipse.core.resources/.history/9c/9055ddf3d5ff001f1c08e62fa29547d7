#include <avr/io.h>
#include <avr/sleep.h>
#include <util/delay.h>

#define BIT(a) (1 << a)

#ifndef cbi
#define cbi(sfr, bit)     (_SFR_BYTE(sfr) &= ~_BV(bit))
#endif
#ifndef sbi
#define sbi(sfr, bit)     (_SFR_BYTE(sfr) |= _BV(bit))
#endif


uint8_t getcap(uint8_t pin, uint8_t sampletime, uint8_t waittime) {
	KEYDDR &= ~pin; //Pin als Eingang -> laden lassen
	while(waittime--) { nop(); } //etwas Zeit verstreichen
	while(!(KEYPIN & pin) && --sampletime); //Zeit messen
	KEYDDR |= pin; //Pin als Ausgang -> entladen
	return sampletime;
}


int main()
{
	while(1)
	{
		PORTB |= (1<< PB3);
		_delay_ms(10);
		PORTB &= 0xff ^ (1<< PB3);
		_delay_ms(10);
	}
}
